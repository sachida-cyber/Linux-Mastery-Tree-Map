<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flexible D3 Treemap Visualization</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
    </head>
<body class="light-mode">
    <div id="app">
        <header class="header">
            <h1>Flexible Treemap Navigator</h1>
            <div class="controls">
                <input type="text" id="searchInput" placeholder="Search by node name..." aria-label="Search treemap nodes by name">
                <button id="exportSvgBtn" title="Download as SVG" aria-label="Export visualization as SVG">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                </button>
                <button id="exportPngBtn" title="Download as PNG" aria-label="Export visualization as PNG">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                </button>
                <button id="themeToggle" title="Toggle Light/Dark Mode" aria-label="Toggle light and dark color mode">
                    <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
                    <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
                </button>
            </div>
        </header>

        <nav id="breadcrumb" class="breadcrumb" aria-label="Treemap navigation">
            <button id="backButton" title="Go up one level (Esc key)" aria-label="Go back to the parent node" disabled>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
                Back (Esc)
            </button>
            <div id="pathContainer"></div>
        </nav>

        <main class="main-content">
            <div id="treemap-container" class="treemap-container" role="figure" aria-label="Hierarchical Treemap Visualization">
                </div>

            <aside class="info-panel">
                <section class="info-box">
                    <h2>Color Scale / Depth Legend</h2>
                    <p>The color of a node indicates its **depth** in the hierarchy (e.g., Level 1 is a primary category). A smooth transition of pastel colors is used.</p>
                    <div id="legendContainer" class="legend-container">
                        </div>
                </section>
                <section class="info-box">
                    <h2>How It Works & Tips</h2>
                    <p>
                        **Area Size:** The size of each rectangle is proportional to its **value**. Larger rectangles represent nodes with a higher total value.
                    </p>
                    <p>
                        **Zoom/Navigate:** **Click** on any rectangular node with children to **zoom in**. Use the **Back button** or a segment in the **breadcrumb** to zoom out.
                    </p>
                    <p>
                        **Accessibility:** Press **'Esc'** to navigate back (zoom out) from the current view. Use **Tab** to focus on interactive elements.
                    </p>
                </section>
            </aside>
        </main>
    </div>

    <div id="treemap-tooltip" class="treemap-tooltip" role="tooltip" aria-live="polite" style="display: none;"></div>

    <script src="script.js"></script>
</body>
</html>
